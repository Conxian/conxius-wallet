<<<<<<< SEARCH
        if (derived.privateKey) {
          const child = bip32.fromPrivateKey(Buffer.from(derived.privateKey, 'hex'), Buffer.alloc(32));
          signature = Buffer.from(child.sign(Buffer.from(payloadHash))).toString("hex");
        }
=======
        if (derived.privateKey) {
          const privKeyBuf = Buffer.from(derived.privateKey, 'hex');
          try {
            const child = bip32.fromPrivateKey(privKeyBuf, Buffer.alloc(32));
            signature = Buffer.from(child.sign(Buffer.from(payloadHash))).toString("hex");
          } finally {
            privKeyBuf.fill(0);
          }
        }
>>>>>>> REPLACE
<<<<<<< SEARCH
      if (derived.privateKey) {
          const child = bip32.fromPrivateKey(Buffer.from(derived.privateKey, 'hex'), Buffer.alloc(32));
          const stacksHash = Buffer.from(bitcoin.crypto.sha256(Buffer.from("stacks-sig")));
          signature = Buffer.from(child.sign(stacksHash)).toString("hex");
      }
=======
      if (derived.privateKey) {
          const privKeyBuf = Buffer.from(derived.privateKey, 'hex');
          try {
            const child = bip32.fromPrivateKey(privKeyBuf, Buffer.alloc(32));
            const stacksHash = Buffer.from(bitcoin.crypto.sha256(Buffer.from("stacks-sig")));
            signature = Buffer.from(child.sign(stacksHash)).toString("hex");
          } finally {
            privKeyBuf.fill(0);
          }
      }
>>>>>>> REPLACE
